<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>AKT • Projeções</title>
<style>
:root{--bg1:#0a0a0a;--bg2:#000;--text:#e5e5e5;--sub:#a1a1aa;--border:#27272a;--panel:rgba(24,24,27,.6);--panel2:rgba(17,17,19,.7);--accent:#f97316;--good:#86efac;--bad:#fca5a5;}
*{box-sizing:border-box}
body{margin:0;min-height:100vh;color:var(--text);background:linear-gradient(var(--bg1),var(--bg2));font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica Neue,Arial}
.container{max-width:720px;margin:0 auto;padding:0 20px}
header{display:flex;align-items:center;justify-content:space-between;padding:22px 0}
h1{font-size:22px;margin:0;font-weight:600}
.section{margin:16px 0}
.card{background:var(--panel);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,.4);padding:16px}
.card h2{font-size:18px;margin:0 0 10px;font-weight:600}
label.f{display:grid;gap:4px;margin-bottom:8px}
label.f span{font-size:12px;color:var(--sub)}
input.inp,select.inp{width:100%;border:1px solid var(--border);border-radius:12px;background:rgba(39,39,42,.4);color:var(--text);padding:8px 10px}
.two{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.seg{display:inline-flex;border:1px solid var(--border);border-radius:12px;overflow:hidden}
.seg button{padding:8px 12px;font-size:13px;background:transparent;border-left:1px solid var(--border);color:var(--text);cursor:pointer}
.seg button:first-child{border-left:none}
.seg button.active{background:var(--accent);color:#000}
.big{font-size:24px;font-weight:700}
.note{margin-top:8px;font-size:12px;color:var(--sub)}
footer{padding:24px 0;text-align:center;font-size:12px;color:var(--sub)}
@media(max-width:720px){.two{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="container">
  <header>
    <h1>AKT • Projeções</h1>
  </header>
</div>

<main class="container">
  <section class="section">
    <div class="card">
      <h2>Parâmetros</h2>
      <div class="two">
        <label class="f"><span>Direção</span>
          <div class="seg" id="dirSeg">
            <button type="button" data-dir="loss" class="active">Perder</button>
            <button type="button" data-dir="gain">Ganhar</button>
          </div>
        </label>
        <label class="f"><span>Ritmo semanal (kg/sem)</span><input id="rate" class="inp" type="number" step="0.05" min="0.1" value="0.5"></label>

        <label class="f"><span>Peso atual (kg)</span><input id="currentW" class="inp" type="number" step="0.1" min="20" value="80"></label>
        <label class="f"><span>Peso alvo (kg)</span><input id="targetW" class="inp" type="number" step="0.1" min="20" value="75"></label>

        <label class="f"><span>Seu gasto calórico (kcal/dia)</span><input id="tdee" class="inp" type="number" step="1" min="500" value="2600"></label>
        <div></div>

        <label class="f"><span>Δ diário (kcal)</span><div class="big" id="delta">—</div></label>
        <label class="f"><span>Ingestão projetada</span><div class="big" id="intakeProjected">—</div></label>
        <label class="f"><span>Semanas estimadas</span><div class="big" id="weeksNeed">—</div></label>
        <label class="f"><span>Data estimada</span><div class="big" id="targetDate">—</div></label>
      </div>
      <p class="note">Você pode preencher o valor manualmente (use o calculado na página Perfil).</p>
    </div>
  </section>
</main>

<div class="container"><footer>© AKT Labs — (educacional; não substitui avaliação clínica).</footer></div>

<script>
document.addEventListener('DOMContentLoaded',()=>{
  const $=(s,r=document)=>r.querySelector(s);
  const $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
  const round=(v,n=1)=>Number.isFinite(v)?Number(v.toFixed(n)):0;
  const clamp=(v,min,max)=>Math.min(Math.max(v,min),max);
  const save=(k,v)=>{try{localStorage.setItem(k,JSON.stringify(v));}catch(e){}}
  const load=(k,d)=>{try{const r=localStorage.getItem(k);return r?JSON.parse(r):d;}catch(e){return d;}}

  let direction = load('direction','loss');
  let rate = load('rate',0.5);
  let currentW = load('currentW',80);
  let targetW = load('targetW',75);
  let tdee = load('projecoes_tdee',2600);

  function bindNum(id,get,set){ const el=$(id); if(!el) return; el.value=String(get()); el.addEventListener('input',()=>{ set(Number(el.value)); recalc();}); }
  function dailyDeltaFromWeeklyRate(kgPerWeek){ return (kgPerWeek*7700)/7; }
  function weeksToTarget(cw,tw,wr){ const diff=Math.abs(tw-cw); return wr>0? diff/wr : 0; }

  function syncDir(){ $$('#dirSeg button').forEach(b=>b.classList.remove('active')); const act=document.querySelector(`#dirSeg button[data-dir="${direction}"]`); if(act) act.classList.add('active'); }
  const dirSeg=$('#dirSeg');
  if(dirSeg){
    dirSeg.addEventListener('click',e=>{ const t=e.target; if(!(t instanceof HTMLButtonElement)) return;
      direction=t.getAttribute('data-dir')||'loss'; save('direction',direction); syncDir(); recalc(); });
  }

  bindNum('#rate',()=>rate,v=>{rate=clamp(v,0.1,1.5); save('rate',rate); });
  bindNum('#currentW',()=>currentW,v=>{currentW=v; save('currentW',v); });
  bindNum('#targetW',()=>targetW,v=>{targetW=v; save('targetW',v); });
  bindNum('#tdee',()=>tdee,v=>{tdee=v; save('projecoes_tdee',v); });

  function recalc(){
    const sign = (direction==='loss' ? -1 : 1);
    const delta = round(dailyDeltaFromWeeklyRate(Number(rate))*sign,0);
    const intake = round(Number(tdee) + delta,0);
    const weeks = round(weeksToTarget(Number(currentW), Number(targetW), Number(rate)),1);
    const date = (Number.isFinite(weeks) && weeks>0)? (function(){ const now=new Date(); const ms=Math.round(weeks*7)*24*3600*1000; const d=new Date(now.getTime()+ms); return d.toLocaleDateString(); })() : '—';

    const deltaEl=$('#delta'), intakeEl=$('#intakeProjected'), weeksEl=$('#weeksNeed'), dateEl=$('#targetDate');
    if(deltaEl){ deltaEl.textContent = `${delta>0?'+':''}${delta}`; deltaEl.style.color = delta<0? 'var(--bad)' : 'var(--good)'; }
    if(intakeEl) intakeEl.textContent = Number.isFinite(intake)? `${intake} kcal/dia` : '—';
    if(weeksEl) weeksEl.textContent = Number.isFinite(weeks)? String(weeks) : '—';
    if(dateEl) dateEl.textContent = date;
  }

  syncDir(); recalc();
});
</script>
</body>
</html>
